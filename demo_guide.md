## שלב 0: הכנות

**מה להגיד:** "שלום לכולם. היום נדגים פריסה של אפליקציית Full-Stack פשוטה ב-OpenShift, הכוללת מסד נתונים MySQL ושירות API בפייתון. נראה איך מרימים את כל התשתית מאפס, שלב אחר שלב, גם באמצעות קבצי YAML וגם באמצעות פקודות ישירות. לפני שנתחיל, יצרתי פרויקט חדש ונקי בשם `my-live-demo`."

## שלב 1: בניית Docker Image

**מה להגיד:** "השלב הראשון והבסיסי הוא לארוז את אפליקציית הפייתון שלנו לתוך Docker Image, שהוא יחידת הפריסה הניידת שלנו. לאחר מכן, נדחוף אותו למאגר מרכזי, Docker Hub, כדי ש-OpenShift יוכל למשוך אותו משם."

**(הרץ את פקודות `docker build` ו-`docker push`)**

## שלב 2: יצירת Secret לסיסמאות

**מה להגיד:** "אבטחה היא הדבר הראשון שנדאג לו. במקום לשמור סיסמאות בקוד, ניצור אובייקט `Secret` ב-OpenShift שיחזיק אותן בצורה מאובטחת. הדרך המומלצת היא להגדיר את ה-Secret בקובץ YAML, כי זה מאפשר לנו לנהל את התשתית שלנו כקוד."

**(הרץ את פקודת `oc apply` על `01-mysql-secret.yaml`)**

**מה להגיד (אופציונלי):** "אפשר להראות שגם ניתן ליצור את אותו Secret ישירות מה-CLI, אבל זו פחות פרקטיקה מומלצת לפרודקשן."

**(הרץ את פקודת `oc get secret` כדי להראות שהוא נוצר)**

## שלב 3: יצירת אחסון קבוע (PVC)

**מה להגיד:** "מסד נתונים חייב לשמור מידע באופן קבוע. ה-PVC, או Persistent Volume Claim, הוא הבקשה שלנו מ-OpenShift ל'דיסק' וירטואלי. הנתונים של מסד הנתונים יישמרו עליו ויישמרו גם אם הקונטיינר יופעל מחדש."

**(הרץ את פקודת `oc apply` על `02-mysql-pvc.yaml`)**

**(הרץ `oc get pvc` והראה שהסטטוס הוא `Bound`, כלומר הוקצה לו שטח אחסון פיזי)**

## שלב 4: פריסת MySQL

**מה להגיד:** "עכשיו נרים את מסד הנתונים עצמו. נשתמש בקובץ `Deployment` שמגדיר איך להריץ את קונטיינר ה-MySQL, ומחבר אותו ל-Secret שיצרנו קודם (כדי לקבל סיסמאות) ול-PVC (כדי לשמור נתונים). בנוסף, ניצור `Service` שנותן למסד הנתונים כתובת רשת פנימית קבועה."

**(הרץ את פקודות `oc apply` על `03-mysql-deployment.yaml` ו-`04-mysql-service.yaml`)**

**מה להגיד:** "הפריסה לוקחת קצת זמן, כי OpenShift צריך למשוך את האימג' ולהפעיל את ה-Pod. נשתמש בפקודת `oc wait` כדי שהסקריפט ימתין עד שה-Pod יהיה במצב `Ready` לפני שנמשיך."

**(הרץ את פקודת `oc wait`)**

## שלב 5: פריסת אפליקציית FastAPI

**מה להגיד:** "עכשיו, כשמסד הנתונים מוכן, נפרוס את אפליקציית ה-FastAPI שלנו. ה-Deployment שלה מוגדר למשוך את האימג' שבנינו קודם מ-Docker Hub. חשוב מכך, הוא מוגדר להזריק את פרטי הגישה ל-DB כמשתני סביבה, אותם הוא לוקח מה-`Secret` שיצרנו בהתחלה."

**(הרץ את פקודת ה-`sed` המשולבת עם `oc apply` ואת ה-`oc apply` ל-Service)**

**מה להגיד:** "כמו קודם, נמתין שה-API יהיה מוכן עם `oc wait`."

**(הרץ את פקודת `oc wait` של ה-API)**

## שלב 6: אתחול הנתונים ב-DB

**מה להגיד:** "כרגע מסד הנתונים שלנו ריק. כדי שיהיה לנו מידע להציג, אנחנו צריכים לאתחל אותו. נעשה זאת בתהליך של שלושה שלבים: נמצא את שם ה-Pod של MySQL, נעתיק אליו את קבצי ה-SQL שלנו עם `oc cp`, ולבסוף נשתמש ב-`oc exec` כדי להריץ את הפקודות בתוך ה-Pod."

**(הרץ את ארבע הפקודות של שלב 6: `MYSQL_POD=...`, `oc cp...`, `MYSQL_PASSWORD=...`, `oc exec...`)**

## שלב 7: חשיפת האפליקציה (Route)

**מה להגיד:** "השלב האחרון הוא לחשוף את ה-API שלנו לעולם החיצון כדי שנוכל לגשת אליו מהדפדפן. ב-OpenShift, עושים זאת באמצעות אובייקט `Route`."

**(הרץ את פקודת `oc apply` על `07-fastapi-route.yaml`)**

**מה להגיד:** "עכשיו שה-Route נוצר, בואו נמצא את הכתובת ונבדוק שהכל עובד."

**(הרץ את הפקודה האחרונה שמדפיסה את ה-URL. העתק את ה-URL לדפדפן והראה את התוצאה של `/data` ושל `/docs`)**

## שלב 8: ניקוי הסביבה

**מה להגיד:** "לסיום, כדי לשמור על סביבה נקייה, נמחק את כל המשאבים שיצרנו. מכיוון שהגדרנו את כולם עם תוויות (`labels`), אפשר למחוק אותם בקלות."

**(הרץ את פקודות הניקוי)**